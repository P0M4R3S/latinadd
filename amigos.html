<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="css/style.css">
    <title>Latinadd - La red social de los latinos</title>
</head>
<body>
    <!--Navegador superior------------------------------------------------------------------>
    <div class="container-fluid stiky-top navegador">
        <div class="row h-100">
            <div class="col-2 logo align-items-center d-flex">
                <img src="img/icono-tras.png" alt="">
            </div>
            <div class="col-2 sandwich align-items-center justify-content-end d-flex">
                <img src="img/sandwich.png" alt="">
            </div>
            <div class="col-6 buscador align-items-center d-flex">
                <input type="text" class="buscador-form" placeholder="">
            </div>
            <div class="col-2 lupa align-items-center justify-content-end d-flex">
                <img src="img/lupa.png" alt="">
            </div>
        </div>
    </div>
    <!--Menu inferior------------------------------------------------------------------>
    <div class="container-fluid subMenu">
        <div class="row h-100 justify-content-center align-items-center">
            <div class="col bntSub tienda">
                <svg fill="white" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M547.6 103.8L490.3 13.1C485.2 5 476.1 0 466.4 0L109.6 0C99.9 0 90.8 5 85.7 13.1L28.3 103.8c-29.6 46.8-3.4 111.9 51.9 119.4c4 .5 8.1 .8 12.1 .8c26.1 0 49.3-11.4 65.2-29c15.9 17.6 39.1 29 65.2 29c26.1 0 49.3-11.4 65.2-29c15.9 17.6 39.1 29 65.2 29c26.2 0 49.3-11.4 65.2-29c16 17.6 39.1 29 65.2 29c4.1 0 8.1-.3 12.1-.8c55.5-7.4 81.8-72.5 52.1-119.4zM499.7 254.9c0 0 0 0-.1 0c-5.3 .7-10.7 1.1-16.2 1.1c-12.4 0-24.3-1.9-35.4-5.3L448 384l-320 0 0-133.4c-11.2 3.5-23.2 5.4-35.6 5.4c-5.5 0-11-.4-16.3-1.1l-.1 0c-4.1-.6-8.1-1.3-12-2.3L64 384l0 64c0 35.3 28.7 64 64 64l320 0c35.3 0 64-28.7 64-64l0-64 0-131.4c-4 1-8 1.8-12.3 2.3z"/></svg>
            </div>
            <div class="col bntSub grupos">
                <svg fill="white" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path d="M72 88a56 56 0 1 1 112 0A56 56 0 1 1 72 88zM64 245.7C54 256.9 48 271.8 48 288s6 31.1 16 42.3l0-84.7zm144.4-49.3C178.7 222.7 160 261.2 160 304c0 34.3 12 65.8 32 90.5l0 21.5c0 17.7-14.3 32-32 32l-64 0c-17.7 0-32-14.3-32-32l0-26.8C26.2 371.2 0 332.7 0 288c0-61.9 50.1-112 112-112l32 0c24 0 46.2 7.5 64.4 20.3zM448 416l0-21.5c20-24.7 32-56.2 32-90.5c0-42.8-18.7-81.3-48.4-107.7C449.8 183.5 472 176 496 176l32 0c61.9 0 112 50.1 112 112c0 44.7-26.2 83.2-64 101.2l0 26.8c0 17.7-14.3 32-32 32l-64 0c-17.7 0-32-14.3-32-32zm8-328a56 56 0 1 1 112 0A56 56 0 1 1 456 88zM576 245.7l0 84.7c10-11.3 16-26.1 16-42.3s-6-31.1-16-42.3zM320 32a64 64 0 1 1 0 128 64 64 0 1 1 0-128zM240 304c0 16.2 6 31 16 42.3l0-84.7c-10 11.3-16 26.1-16 42.3zm144-42.3l0 84.7c10-11.3 16-26.1 16-42.3s-6-31.1-16-42.3zM448 304c0 44.7-26.2 83.2-64 101.2l0 42.8c0 17.7-14.3 32-32 32l-64 0c-17.7 0-32-14.3-32-32l0-42.8c-37.8-18-64-56.5-64-101.2c0-61.9 50.1-112 112-112l32 0c61.9 0 112 50.1 112 112z"/></svg>
            </div>
            <div class="col bntSub novedades">
                <svg fill="white" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M64 32C28.7 32 0 60.7 0 96L0 416c0 35.3 28.7 64 64 64l320 0c35.3 0 64-28.7 64-64l0-320c0-35.3-28.7-64-64-64L64 32zM96 136c0-13.3 10.7-24 24-24c137 0 248 111 248 248c0 13.3-10.7 24-24 24s-24-10.7-24-24c0-110.5-89.5-200-200-200c-13.3 0-24-10.7-24-24zm0 96c0-13.3 10.7-24 24-24c83.9 0 152 68.1 152 152c0 13.3-10.7 24-24 24s-24-10.7-24-24c0-57.4-46.6-104-104-104c-13.3 0-24-10.7-24-24zm0 120a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"/></svg>
            </div>
            <div class="col bntSub notificaciones">
                <div class="iconoCampana position-relative d-inline-block">
                    <svg fill="white" xmlns="http://www.w3.org/2000/svg" width="22" height="22" class="bi bi-bell-fill" viewBox="0 0 16 16">
                        <path d="M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2m.995-14.901a1 1 0 1 0-1.99 0A5 5 0 0 0 3 6c0 1.098-.5 6-2 7h14c-1.5-1-2-5.902-2-7 0-2.42-1.72-4.44-4.005-4.901"/>
                    </svg>
                    <span id="puntoNotificaciones" class="puntoRojo d-none"></span>
                </div>
            </div>
            <div class="col bntSub mensajes">
                <div class="iconoCampana position-relative d-inline-block">
                    <svg fill="white" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M215.4 96L144 96l-36.2 0L96 96l0 8.8L96 144l0 40.4 0 89L.2 202.5c1.6-18.1 10.9-34.9 25.7-45.8L48 140.3 48 96c0-26.5 21.5-48 48-48l76.6 0 49.9-36.9C232.2 3.9 243.9 0 256 0s23.8 3.9 33.5 11L339.4 48 416 48c26.5 0 48 21.5 48 48l0 44.3 22.1 16.4c14.8 10.9 24.1 27.7 25.7 45.8L416 273.4l0-89 0-40.4 0-39.2 0-8.8-11.8 0L368 96l-71.4 0-81.3 0zM0 448L0 242.1 217.6 403.3c11.1 8.2 24.6 12.7 38.4 12.7s27.3-4.4 38.4-12.7L512 242.1 512 448s0 0 0 0c0 35.3-28.7 64-64 64L64 512c-35.3 0-64-28.7-64-64c0 0 0 0 0 0zM176 160l160 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-160 0c-8.8 0-16-7.2-16-16s7.2-16 16-16zm0 64l160 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-160 0c-8.8 0-16-7.2-16-16s7.2-16 16-16z"/></svg>
                    <span id="puntoMensajes" class="puntoRojo d-none"></span>
                </div>
            </div>
        </div>
    </div>

    <!--Contenido------------------------------------------------------------------>
    <div class="container-fluid contenido mb-5 pt-5">
        <div class="row text-center mt-5">
            <div class="col pulsador" id="pulsador1">
                <div class="pulsador-content">
                    <span>Todos</span>
                </div>
            </div>
            <div class="col pulsador" id="pulsador2">
                <div class="pulsador-content">
                    <span>Amigos</span>
                </div>
            </div>
            <div class="col pulsador" id="pulsador3">
                <div class="pulsador-content">
                    <span>Sugerencias</span>
                </div>
            </div>
        </div>
        
        <div class="listaAmigos" style="padding-bottom: 200px;">

        </div>
    </div>

    <!--Menu lateral--------------------------------------------------------------->
    <div class="container-fluid menuLateral">
        <div class="lateral">
            <div class="row mt-3 flecha">
                <img id="btnFlecha" src="img/arrow-left.svg" alt="">
            </div>
            <div class="row perfilLateral">
                <div class="col-3 perfil">
                    <img class="imgLateral" id="imgLateral" src="img/3.jpg" alt="">
                </div>
                <div class="col-9">
                    <span class="nombreLateral">Nombre usuario</span> <br>
                    <span class="bienvenidaLateral">Bienvenid@</span>
                </div>
            </div>
            <div class="row pb-5">
                <div class="btnCerrar justify-content-center d-flex" id="btnCerrarSesion">
                    <span>CERRAR SESIÓN</span>
                </div>
            </div>
            <div class="row p-3 novedades">
                <div class="col-2">
                    <svg fill="lightgrey" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M64 32C28.7 32 0 60.7 0 96L0 416c0 35.3 28.7 64 64 64l320 0c35.3 0 64-28.7 64-64l0-320c0-35.3-28.7-64-64-64L64 32zM96 136c0-13.3 10.7-24 24-24c137 0 248 111 248 248c0 13.3-10.7 24-24 24s-24-10.7-24-24c0-110.5-89.5-200-200-200c-13.3 0-24-10.7-24-24zm0 96c0-13.3 10.7-24 24-24c83.9 0 152 68.1 152 152c0 13.3-10.7 24-24 24s-24-10.7-24-24c0-57.4-46.6-104-104-104c-13.3 0-24-10.7-24-24zm0 120a32 32 0 1 1 64 0 32 32 0 1 1 -64 0z"/></svg>
                </div>
                <div class="col-9">
                    <span class="tituloLateral">Novedades</span>
                </div>
            </div>

            <div class="row p-3 eventos">
                <div class="col-2">
                    <svg fill="lightgrey" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path d="M128 0c17.7 0 32 14.3 32 32l0 32 128 0 0-32c0-17.7 14.3-32 32-32s32 14.3 32 32l0 32 48 0c26.5 0 48 21.5 48 48l0 48L0 160l0-48C0 85.5 21.5 64 48 64l48 0 0-32c0-17.7 14.3-32 32-32zM0 192l448 0 0 272c0 26.5-21.5 48-48 48L48 512c-26.5 0-48-21.5-48-48L0 192zm80 64c-8.8 0-16 7.2-16 16l0 96c0 8.8 7.2 16 16 16l96 0c8.8 0 16-7.2 16-16l0-96c0-8.8-7.2-16-16-16l-96 0z"/></svg>
                </div>
                <div class="col-9">
                    <span class="tituloLateral">Páginas</span>
                </div>
            </div>
            <div class="row p-3 tienda">
                <div class="col-2">
                    <svg fill="lightgrey" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><path d="M547.6 103.8L490.3 13.1C485.2 5 476.1 0 466.4 0L109.6 0C99.9 0 90.8 5 85.7 13.1L28.3 103.8c-29.6 46.8-3.4 111.9 51.9 119.4c4 .5 8.1 .8 12.1 .8c26.1 0 49.3-11.4 65.2-29c15.9 17.6 39.1 29 65.2 29c26.1 0 49.3-11.4 65.2-29c15.9 17.6 39.1 29 65.2 29c26.2 0 49.3-11.4 65.2-29c16 17.6 39.1 29 65.2 29c4.1 0 8.1-.3 12.1-.8c55.5-7.4 81.8-72.5 52.1-119.4zM499.7 254.9c0 0 0 0-.1 0c-5.3 .7-10.7 1.1-16.2 1.1c-12.4 0-24.3-1.9-35.4-5.3L448 384l-320 0 0-133.4c-11.2 3.5-23.2 5.4-35.6 5.4c-5.5 0-11-.4-16.3-1.1l-.1 0c-4.1-.6-8.1-1.3-12-2.3L64 384l0 64c0 35.3 28.7 64 64 64l320 0c35.3 0 64-28.7 64-64l0-64 0-131.4c-4 1-8 1.8-12.3 2.3z"/></svg>
                </div>
                <div class="col-9">
                    <span class="tituloLateral">Tienda</span>
                </div>
            </div>
            <div class="row p-3 amigos">
                <div class="col-2">
                    <svg fill="lightgrey" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M47.6 300.4L228.3 469.1c7.5 7 17.4 10.9 27.7 10.9s20.2-3.9 27.7-10.9L464.4 300.4c30.4-28.3 47.6-68 47.6-109.5v-5.8c0-69.9-50.5-129.5-119.4-141C347 36.5 300.6 51.4 268 84L256 96 244 84c-32.6-32.6-79-47.5-124.6-39.9C50.5 55.6 0 115.2 0 185.1v5.8c0 41.5 17.2 81.2 47.6 109.5z"/></svg>
                </div>
                <div class="col-9">
                    <span class="tituloLateral">Amigos</span>
                </div>
            </div>
            <div class="row p-3 mensajes">
                <div class="col-2">
                    <svg fill="lightgrey" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path d="M215.4 96L144 96l-36.2 0L96 96l0 8.8L96 144l0 40.4 0 89L.2 202.5c1.6-18.1 10.9-34.9 25.7-45.8L48 140.3 48 96c0-26.5 21.5-48 48-48l76.6 0 49.9-36.9C232.2 3.9 243.9 0 256 0s23.8 3.9 33.5 11L339.4 48 416 48c26.5 0 48 21.5 48 48l0 44.3 22.1 16.4c14.8 10.9 24.1 27.7 25.7 45.8L416 273.4l0-89 0-40.4 0-39.2 0-8.8-11.8 0L368 96l-71.4 0-81.3 0zM0 448L0 242.1 217.6 403.3c11.1 8.2 24.6 12.7 38.4 12.7s27.3-4.4 38.4-12.7L512 242.1 512 448s0 0 0 0c0 35.3-28.7 64-64 64L64 512c-35.3 0-64-28.7-64-64c0 0 0 0 0 0zM176 160l160 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-160 0c-8.8 0-16-7.2-16-16s7.2-16 16-16zm0 64l160 0c8.8 0 16 7.2 16 16s-7.2 16-16 16l-160 0c-8.8 0-16-7.2-16-16s7.2-16 16-16z"/></svg>
                </div>
                <div class="col-9">
                    <span class="tituloLateral">Mensajes</span>
                </div>
            </div>
            <div class="row p-3 perfil">
                <div class="col-2">
                    <svg fill="lightgrey" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><path d="M224 256A128 128 0 1 0 224 0a128 128 0 1 0 0 256zm-45.7 48C79.8 304 0 383.8 0 482.3C0 498.7 13.3 512 29.7 512l293.1 0c-3.1-8.8-3.7-18.4-1.4-27.8l15-60.1c2.8-11.3 8.6-21.5 16.8-29.7l40.3-40.3c-32.1-31-75.7-50.1-123.9-50.1l-91.4 0zm435.5-68.3c-15.6-15.6-40.9-15.6-56.6 0l-29.4 29.4 71 71 29.4-29.4c15.6-15.6 15.6-40.9 0-56.6l-14.4-14.4zM375.9 417c-4.1 4.1-7 9.2-8.4 14.9l-15 60.1c-1.4 5.5 .2 11.2 4.2 15.2s9.7 5.6 15.2 4.2l60.1-15c5.6-1.4 10.8-4.3 14.9-8.4L576.1 358.7l-71-71L375.9 417z"/></svg>
                </div>
                <div class="col-9">
                    <span class="tituloLateral">Mi perfil</span>
                </div>
            </div>
        </div>
        
    </div>

    <!--Cargador------------------------------------------------------------------>
    <div class="cargador">
        <div class="cargCentral">
            <div class="imgCargador"><img src="img/icono-tras.png" alt=""></div>
            <span class="tituloCargador">LATINADD</span>
            <span class="subtituloCargador">CARGANDO...</span>
            <div class="sprin"></div>
        </div>
    </div>


    <!--Sources de JS-->
    <script src="node_modules/jquery/dist/jquery.min.js"></script>
    <script src="node_modules/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/cargarPerfil.js"></script>
    <script src="js/modalCompartir.js"></script>
    <script src="js/modalMensajes.js"></script>
    <script src="js/modalOpcionesPost.js"></script>
    <script src="js/amigos.js"></script>
    <script src="js/notificaciones.js"></script>
    <script>
        $(document).ready(function(){
            $("#modalCompartir").hide();
            $("#modalMensaje").hide();
            $("#modalConfPost").hide();
            $("#modalCompartir").removeClass("d-none");
            $("#modalMensaje").removeClass("d-none");
            $("#modalConfPost").removeClass("d-none");
            
             //Control de localStorage
             let idUsuario = localStorage.getItem("idUsuario");
            let tokenUsuario = localStorage.getItem("tokenUsuario");
            if (idUsuario && tokenUsuario) {
                $.ajax({
                    url: 'API/usuarios/comprobarLocal.php',
                    type: 'POST',
                    data: { 
                        id: idUsuario,
                        token: tokenUsuario 
                    },
                    dataType: 'json',
                    success: function(data) {
                        if (!data.success) {
                            localStorage.removeItem("idUsuario");
                            localStorage.removeItem("tokenUsuario");
                            window.location.href = 'index.html';
                        }else{
                            cargarPerfil(() => cargarAmigos());
                        }
                    },
                    error: function(xhr, status, error) {
                        console.error('Error en AJAX:', error);
                        localStorage.removeItem("idUsuario");
                        localStorage.removeItem("tokenUsuario");
                        window.location.href = 'index.html';
                    }
                });
            } else {
                window.location.href = 'index.html';
            }

            //Funcionalidad del boton de cerrar sesion
            $("#btnCerrarSesion").click(function() {
                localStorage.removeItem("idUsuario");
                localStorage.removeItem("tokenUsuario");
                window.location.href = "index.html";
            });

            //Funcionalidad para mostrar el cargador 3 segundos
            setTimeout(function() {
                $(".cargador").fadeOut(200);
            }, 500);

            //Funcionalidad para mostrar el menú lateral
            $(".sandwich").click(function() {
                $(".menuLateral").fadeIn(200);
                $(".lateral").animate({ left: "0px" }, 300); 
            });

            $("#btnFlecha").click(function() {
                $(".lateral").animate({ left: "-250px" }, 300, function() {
                    $(".menuLateral").fadeOut(200);
                });
            });

            $(".novedades").click(function() { window.location.href = "novedades.html"; });
            $(".grupos").click(function() { window.location.href = "paginas.html"; });
            $(".eventos").click(function() { window.location.href = "paginas.html"; });
            $(".tienda").click(function() { window.location.href = "tienda.html"; });
            $(".foros").click(function() { window.location.href = "foros.html"; });
            $(".amigos").click(function() { window.location.href = "amigos.html"; });
            $(".mensajes").click(function() { window.location.href = "mensajes.html"; });
            $(".perfil").click(function() { window.location.href = "perfil.html"; });
            $(".configuracion").click(function() { window.location.href = "configuracion.html"; });
            $(".privacidad").click(function() { window.location.href = "privacidad.html"; });
            $(".notificaciones").click(function() { window.location.href = "notificaciones.html"; });

            //Control del buscador
            // Capturar click en la lupa
            $(".lupa img").click(function () {
                const query = $(".buscador-form").val().trim();
                if (query.length > 0) {
                    window.location.href = `busqueda.html?query=${encodeURIComponent(query)}`;
                }
            });

            // Capturar Enter en el input
            $(".buscador-form").keypress(function (e) {
                if (e.which === 13) { // Código de tecla Enter
                    e.preventDefault();
                    const query = $(this).val().trim();
                    if (query.length > 0) {
                        window.location.href = `busqueda.html?query=${encodeURIComponent(query)}`;
                    }
                }
            });

            /*Control de notificaciones y mensajes*/
            tieneNotificaciones().then(hay => {
                if (hay) {
                    $("#puntoNotificaciones").removeClass("d-none");
                } else {
                    $("#puntoNotificaciones").addClass("d-none");
                }
            });

            tieneMensajes().then(hay => {
                if (hay) {
                    $("#puntoMensajes").removeClass("d-none");
                } else {
                    $("#puntoMensajes").addClass("d-none");
                }
            });
        });
    </script>
</body>
</html>